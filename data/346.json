{"error": null, "result": {"nr": 346, "upvote_ids": [], "change_log": [{"type": "create", "when": "2015-04-22T08:17:35Z", "uid": "i71i9b92nrr7n4", "data": "i8sgwi3p35b3h8", "anon": "no"}, {"type": "update", "when": "2015-04-22T08:23:48Z", "uid": "i71i9b92nrr7n4", "data": "i8sh4htkzio6np", "anon": "no"}, {"uid": "hs2swpdtr91gu", "to": "i8sgwi3mvwo3h7", "when": "2015-04-23T04:51:30Z", "anon": "no", "data": "i8tozbkopmi2nl", "type": "i_answer"}], "q_edits": [], "i_edits": [], "unique_views": 55, "bookmarked": 3, "config": {}, "history": [{"subject": "关于lab4, local_intr_save/restore", "content": "<p>lab4當中為中断标記設置的兩個宏　(如下)</p>\n<p></p>\n<p>sync.h</p>\n<p></p>\n<p>#define local_intr_save(x)      do { x = __intr_save(); } while (0)<br />#define local_intr_restore(x)   __intr_restore(x);</p>\n<p></p>\n<p>请问为什么local_intr_save需要以do {   } while (0)包著核心部分的x = __intr_save();? 有什么安全原因么</p>\n<p></p>\n<p>另外是result中,　proc.c裡proc_run中的這一段</p>\n<p></p>\n<p>    bool intr_flag;<br />    local_intr_save(intr_flag);<br />    {<br />        proc-&gt;pid = get_pid();<br />        hash_proc(proc);<br />        list_add(&amp;proc_list, &amp;(proc-&gt;list_link));<br />        nr_process &#43;&#43;;<br />    }<br />    local_intr_restore(intr_flag);</p>\n<p></p>\n<p>看不太出來設置中断标記的必要, 求讲解 &#64;&#64;</p>", "created": "2015-04-22T08:23:48Z", "uid": "i71i9b92nrr7n4", "anon": "no"}, {"subject": "关于lab4, local_intr_save", "content": "<p>lab4當中為中断标記設置的兩個宏　(如下)</p>\n<p></p>\n<p>sync.h</p>\n<p></p>\n<p>#define local_intr_save(x)      do { x = __intr_save(); } while (0)<br />#define local_intr_restore(x)   __intr_restore(x);</p>\n<p></p>\n<p>请问为什么local_intr_save需要以do {   } while (0)包著核心部分的x = __intr_save();? 有什么安全原因么 &#64;&#64;</p>", "created": "2015-04-22T08:17:35Z", "uid": "i71i9b92nrr7n4", "anon": "no"}], "data": {"embed_links": []}, "request_instructor_me": false, "folders": ["lab4"], "type": "question", "tag_good": [], "no_answer": 0, "created": "2015-04-22T08:17:35Z", "t": 1433500389736, "id": "i8sgwi3mvwo3h7", "status": "active", "tag_good_arr": [], "default_anonymity": "no", "my_favorite": false, "bucket_order": 2, "is_bookmarked": false, "is_tag_good": false, "bucket_name": "Today", "no_answer_followup": 0, "children": [{"folders": [], "bucket_order": 2, "config": {}, "history": [{"subject": "", "content": "<p>为了保证操作的原子性&#xff0c;不会被中断打断。可以参考以下的讨论 <a href=\"https://www.piazza.com/class/i5j09fnsl7k5x0?cid=309\">https://piazza.com/class/i5j09fnsl7k5x0?cid=309</a> </p>", "created": "2015-04-23T04:51:30Z", "uid": "hs2swpdtr91gu", "anon": "no"}], "data": {"embed_links": []}, "bucket_name": "Today", "is_tag_endorse": false, "children": [], "tag_endorse": [], "tag_endorse_arr": [], "created": "2015-04-23T04:51:30Z", "id": "i8tozbibq8g2nk", "type": "i_answer"}], "request_instructor": 0, "tags": ["lab4", "student"], "s_edits": [], "num_favorites": 0}, "aid": "iajh4bqgl9p4xf"}