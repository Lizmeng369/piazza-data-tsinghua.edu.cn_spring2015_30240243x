{"aid": "iln9oq7kc5j6ul", "result": {"folders": ["lab2"], "unique_views": 52, "request_instructor_me": false, "change_log": [{"data": "ijsmlkqr2r6wj", "anon": "no", "when": "2016-01-24T14:13:49Z", "uid": "ijf9jcjt7oslj", "type": "create"}, {"uid": "hdjonbiyfs62ie", "data": "ijsox069lj33at", "when": "2016-01-24T15:18:41Z", "to": "ijsmlkqovtn6wi", "anon": "no", "type": "i_answer"}, {"to": "ijsmlkqovtn6wi", "anon": "no", "when": "2016-01-24T15:54:55Z", "uid": "ijf9jcjt7oslj", "type": "followup"}, {"data": "ijsqdksj3wq3qi", "anon": "no", "when": "2016-01-24T15:59:34Z", "uid": "ijf9jcjt7oslj", "type": "update"}, {"to": "ijsmlkqovtn6wi", "anon": "no", "when": "2016-01-24T16:08:49Z", "uid": "hdjonbiyfs62ie", "type": "feedback"}, {"to": "ijsmlkqovtn6wi", "anon": "no", "when": "2016-01-24T16:47:49Z", "uid": "ijf9jcjt7oslj", "type": "feedback"}, {"to": "ijsmlkqovtn6wi", "anon": "no", "when": "2016-01-25T03:28:37Z", "uid": "iezimbvr4Kl", "type": "feedback"}, {"to": "ijsmlkqovtn6wi", "anon": "no", "when": "2016-01-25T03:36:10Z", "uid": "iezimbvr4Kl", "type": "feedback"}, {"to": "ijsmlkqovtn6wi", "anon": "no", "when": "2016-01-25T04:08:16Z", "uid": "ijf9jcjt7oslj", "type": "feedback"}, {"to": "ijsmlkqovtn6wi", "anon": "no", "when": "2016-01-25T14:41:32Z", "uid": "ijf9jcjt7oslj", "type": "feedback"}, {"to": "ijsmlkqovtn6wi", "anon": "no", "when": "2016-01-25T15:50:41Z", "uid": "hdjonbiyfs62ie", "type": "feedback"}], "upvote_ids": [], "id": "ijsmlkqovtn6wi", "bookmarked": 5, "no_answer_followup": 0, "i_edits": [], "is_bookmarked": false, "children": [{"folders": [], "created": "2016-01-24T15:18:41Z", "config": {}, "tag_endorse_arr": ["ijf9jcjt7oslj"], "children": [], "bucket_name": "Today", "type": "i_answer", "tag_endorse": [{"name": "wangpeng", "admin": false, "photo": null, "us": false, "email": "yuans07@mails.tsinghua.edu.cn", "role": "student", "facebook_id": null, "id": "ijf9jcjt7oslj"}], "bucket_order": 2, "data": {"embed_links": []}, "id": "ijsox066j033as", "history": [{"content": "<p>空闲物理页信息不是放在空闲页中的&#xff0c;而是内核的全局数据结构中的。所以&#xff0c;这里不是增加4KB的。</p>\n<p></p>\n<p>对于第二个问题&#xff0c;建议仔细看一下page结构体的各字段含义。</p>\n<p></p>\n<p>这个讨论区就是最好的询问地方。建议在问之前&#xff0c;按标签查一下是否有人问过类似的问题。这里已积累了几百个问题讨论了。应该常见的问题都有了。</p>", "anon": "no", "subject": "", "uid": "hdjonbiyfs62ie", "created": "2016-01-24T15:18:41Z"}]}, {"folders": [], "updated": "2016-01-24T15:54:55Z", "no_upvotes": 0, "uid": "ijf9jcjt7oslj", "created": "2016-01-24T15:54:55Z", "type": "followup", "d-bucket": "Yesterday", "id": "ijsq7lapyom1wc", "anon": "no", "bucket_name": "Yesterday", "no_answer": 0, "config": {}, "bucket_order": 3, "data": null, "children": [{"folders": [], "updated": "2016-01-24T16:08:49Z", "uid": "hdjonbiyfs62ie", "created": "2016-01-24T16:08:49Z", "type": "feedback", "d-bucket": "Yesterday", "id": "ijsqpha4rma7kf", "anon": "no", "bucket_name": "Yesterday", "config": {}, "bucket_order": 3, "data": null, "children": [], "subject": "<p>好的。请把你对struct page结构的所有字段的理解描述一下&#xff0c;然后告诉我是否理解了。</p>\n<p></p>\n<p>也欢迎其他同学参与这个问题的讨论。</p>"}, {"folders": [], "updated": "2016-01-24T16:47:49Z", "uid": "ijf9jcjt7oslj", "created": "2016-01-24T16:47:49Z", "type": "feedback", "d-bucket": "Yesterday", "id": "ijss3mlqkc36bx", "anon": "no", "bucket_name": "Yesterday", "config": {}, "bucket_order": 3, "data": null, "children": [], "subject": "<p>我对page的理解是&#xff1a;ref是代表这个页被多少使用者共享&#xff0c;flag代表是否可用来分配&#xff0c;property代表有几个页可用&#xff0c;page_link链接的是其他可用页的page_link</p>\n<p></p>\n<p>我的问题可能描述的不够清楚&#xff1a;</p>\n<p>      现在我假设base值是4096&#xff0c;页数是2个&#xff0c;page结构体大小为20字节&#xff0c;ref,flag,property和page_link各5字节&#xff08;数字是假设长度&#xff0c;实际上不是&#xff09;&#xff0c;第一次循环指针p=4096&#xff0c;,for循环体里进行设置&#xff0c;修改的位置分别是4096&#43;0~4&#xff0c;4096&#43;5~9&#xff0c;4096&#43;10~14&#xff0c;4096&#43;15~19&#xff0c;然后我们把位于4096&#43;4096&#43;15~19里的双向指针节点加入到了free list中&#xff0c;通过这个我们能找到这个页起始位置4096&#xff0c;   </p>\n<p>       我不理解的就是接下来的这个了     </p>\n<p>       p&#43;&#43;,因为结构体长度为20字节&#xff0c;则p现在等于4096&#43;20&#xff0c;按照上面的描述&#xff0c;最终加入free_list中的双向指针节点是4096&#43;35~39&#xff0c;通过他我们找到的空闲页位置是4096&#43;20而不是第二个空闲页的头部8192&#xff0c;而且这两些信息都在第一个空闲页中。</p>\n<p>       老师看一下我分析错误的地方在哪&#xff0c;谢谢</p>\n<p></p>"}, {"folders": [], "updated": "2016-01-25T03:28:37Z", "uid": "iezimbvr4Kl", "created": "2016-01-25T03:28:37Z", "type": "feedback", "d-bucket": "Yesterday", "id": "ijtezphu3sl1k3", "anon": "no", "bucket_name": "Yesterday", "config": {}, "bucket_order": 3, "data": null, "children": [], "subject": "<p>如果你说的是在分配页时&#xff0c;找到的页的空闲头部不是8192&#xff0c;那么请查看default_alloc_pages函数和le2page宏。</p>"}, {"folders": [], "updated": "2016-01-25T03:36:10Z", "uid": "iezimbvr4Kl", "created": "2016-01-25T03:36:10Z", "type": "feedback", "d-bucket": "Yesterday", "id": "ijtf9ezzzlh7j3", "anon": "no", "bucket_name": "Yesterday", "config": {}, "bucket_order": 3, "data": null, "children": [], "subject": "<p></p>"}, {"folders": [], "updated": "2016-01-25T04:08:16Z", "uid": "ijf9jcjt7oslj", "created": "2016-01-25T04:08:16Z", "type": "feedback", "d-bucket": "Yesterday", "id": "ijtgep434929m", "anon": "no", "bucket_name": "Yesterday", "config": {}, "bucket_order": 3, "data": null, "children": [], "subject": "<p>&#64;szqxzh&#xff0c;我的问题是这样&#xff0c;每个page指针的值是否是一个页的起始位置&#xff0c;以及page的信息存放位置在哪里&#xff0c;如果page指针是起始位置为什么循环是加一而不是加4k</p>\n<p></p>\n<p>按照我之前假设的数值&#xff0c;我分析init_memmap第二次循环&#xff0c;加一之后page指针的值并不是起始页的位置&#xff08;因为加1而不是加4k&#xff0c;循环1 p=4096&#xff0c;循环2 p=4096&#43;20&#xff09;&#xff0c;且2个page的信息全部存在第一页的头部&#xff0c;如果第一页被分出去了&#xff0c;信息不就会覆盖么&#xff1f;</p>\n<p></p>\n<p>我看了le2page&#xff0c;觉得page指针应该就是空白页的起始位置吧&#xff0c;这个函数通过page_link的地址减去其在结构体里的偏移得到起始值</p>\n<p></p>\n<p>谢谢指点</p>"}, {"folders": [], "updated": "2016-01-25T14:41:32Z", "uid": "ijf9jcjt7oslj", "created": "2016-01-25T14:41:32Z", "type": "feedback", "id": "iju3135szpx3k7", "anon": "no", "bucket_name": "Today", "config": {}, "bucket_order": 2, "data": null, "children": [], "subject": "<p>谢谢老师和同学&#xff0c;我看的不仔细&#xff0c;忽略了函数调用时传递的参数也调用了pa2page这个函数</p>"}, {"folders": [], "updated": "2016-01-25T15:50:41Z", "uid": "hdjonbiyfs62ie", "created": "2016-01-25T15:50:41Z", "type": "feedback", "id": "iju5i054ma85kk", "anon": "no", "bucket_name": "Today", "config": {}, "bucket_order": 2, "data": null, "children": [], "subject": "<p>我对这个交流给好评。这正是我想看到的网上学习氛围。</p>"}], "subject": "<p>老师&#xff1a;</p>\n<p>  我就第一个问题还想麻烦老师指点一下&#xff0c;我的理解page指针存在内核中&#xff0c;比如第一次循环指针的值为base的值&#xff0c;也就是说page-&gt;ref,flag,property和page_lin这几个值存在base这个地址后面的几个内存单元上&#xff0c;这几个单元在空白物理内存中&#xff0c;然后page指针加一&#xff0c;这样的话下一个page数组指向的位置是base指针后面几个内存单元上&#xff08;这里不是一个页的开始位置&#xff09;&#xff0c;我看分配内存函数&#xff0c;返回的是page指针的值&#xff0c;这样的话&#xff0c;page指针本身就应该是页的开始位置。</p>\n<p>   这个问题我想了一天了&#xff0c;没想明白&#xff0c;还是再麻烦老师一下&#xff0c;多谢</p>"}], "nr": 554, "bucket_order": 2, "config": {}, "status": "active", "tags": ["lab2", "student"], "num_favorites": 1, "bucket_name": "Today", "q_edits": [], "data": {"embed_links": []}, "request_instructor": 0, "created": "2016-01-24T14:13:49Z", "is_tag_good": false, "type": "note", "s_edits": [], "my_favorite": false, "default_anonymity": "no", "t": 1457674375088, "tag_good": [{"admin_permission": 10, "admin": true, "photo": null, "us": false, "email": "xyong@tsinghua.edu.cn", "class_sections": ["课程设计_i5j09fnsl7k5x0", "清华学生_i5j09fnsl7k5x0"], "role": "instructor", "facebook_id": null, "id": "hdjonbiyfs62ie", "name": "Yong XIANG"}], "tag_good_arr": ["hdjonbiyfs62ie"], "history": [{"content": "<p></p><pre>default_init_memmap(struct page *base, size_t n){<br />         ......<br />\tstruct page *p=base;<br />\tfor(;p!=base&#43;n;p&#43;&#43;){<br />\t......<br />\t......<br />\tlist_add(&amp;free_list,&amp;(p-&gt;page_link));<br />\t}<br />\t......<br />\t......<br />}<br />老师&#xff0c;各位同学&#xff1a;<br />\t您好&#xff01;我想就lab2的memmap函数初始化这个咨询一下&#xff0c;我把有疑问的代码贴在上上面了&#xff0c;我的看法是这样的&#xff1a;<br />\t1、此函数接收的是一个包含N页的内存块的基地址&#xff0c;我们要初始化每页的page结构体&#xff0c;我觉得每个page结构体应当是存放在这一页的头部&#xff0c;但是我看答案是通过p&#43;&#43;来进行递增的而不是通过增加4k&#xff0c;这样的话&#xff0c;所有page结构体就会存放在第一页中。<br />\t2、为什么要把每个p-&gt;page_link全部添加进free_list中&#xff0c;难道不是把第一页加进去就可以了么&#xff1f;<br /><br />麻烦老师和各位同学指导我想错的地方&#xff0c;谢谢&#xff0c;个人自学每个人问实在太难受。<br /><br /><br /><br /><br /><br /><br /><br /></pre>", "anon": "no", "subject": "lab2_init_memmap的疑问", "uid": "ijf9jcjt7oslj", "created": "2016-01-24T15:59:34Z"}, {"content": "<p></p><pre>default_init_memmap(struct page *base, size_t n){<br />         ......<br />\tstruct page *p=base;<br />\tfor(;p!=base&#43;n;p&#43;&#43;){<br />\t......<br />\t......<br />\tlist_add(&amp;free_list,&amp;(p-&gt;page_link));<br />\t}<br />\t......<br />\t......<br />}<br />老师&#xff0c;各位同学&#xff1a;<br />\t您好&#xff01;我想就lab2的memmap函数初始化这个咨询一下&#xff0c;我把有疑问的代码贴在上上面了&#xff0c;我的看法是这样的&#xff1a;<br />\t1、此函数接收的是一个包含N页的内存块的基地址&#xff0c;我们要初始化每页的page结构体&#xff0c;我觉得每个page结构体应当是存放在这一页的头部&#xff0c;但是我看答案是通过p&#43;&#43;来进行递增的而不是通过增加4k&#xff0c;这样的话&#xff0c;所有page结构体就会存放在第一页中。<br />\t2、为什么要把每个p-&gt;page_link全部添加进free_list中&#xff0c;难道不是把第一页加进去就可以了么&#xff1f;<br /><br />麻烦老师和各位同学指导我想错的地方&#xff0c;谢谢&#xff0c;个人自学每个人问实在太难受。<br /><br /><br /><br /><br /><br /><br /><br /></pre>", "anon": "no", "subject": "lab2_init_memmap的疑问", "uid": "ijf9jcjt7oslj", "created": "2016-01-24T14:13:49Z"}]}, "error": null}